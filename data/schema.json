{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Gene Statistics Schema",
  "description": "Schema for genomic statistics including coding genes, non-coding genes, and pseudogenes with per-transcript feature statistics",
  "type": "object",
  "properties": {
    "coding_genes": {
      "$ref": "#/definitions/geneCategory"
    },
    "non_coding_genes": {
      "$ref": "#/definitions/geneCategory"
    },
    "pseudogenes": {
      "$ref": "#/definitions/geneCategory"
    }
  },
  "required": ["coding_genes", "non_coding_genes", "pseudogenes"],
  "additionalProperties": false,
  "definitions": {
    "geneCategory": {
      "type": "object",
      "properties": {
        "count": {
          "type": "integer",
          "minimum": 0
        },
        "length_stats": {
          "$ref": "#/definitions/lengthStats"
        },
        "transcripts": {
          "$ref": "#/definitions/transcripts"
        }
      },
      "required": ["count", "length_stats", "transcripts"],
      "additionalProperties": false
    },
    "lengthStats": {
      "type": "object",
      "properties": {
        "min": {
          "type": "integer",
          "minimum": 0
        },
        "max": {
          "type": "integer",
          "minimum": 0
        },
        "mean": {
          "type": "number",
          "minimum": 0
        },
        "median": {
          "type": "number",
          "minimum": 0
        }
      },
      "required": ["min", "max", "mean", "median"],
      "additionalProperties": false
    },
    "transcripts": {
      "type": "object",
      "properties": {
        "count": {
          "type": "integer",
          "minimum": 0
        },
        "per_gene": {
          "type": "number",
          "minimum": 0
        },
        "types": {
          "type": "object",
          "patternProperties": {
            ".*": {
              "$ref": "#/definitions/transcriptType"
            }
          },
          "additionalProperties": false
        }
      },
      "required": ["count", "per_gene", "types"],
      "additionalProperties": false
    },
    "transcriptType": {
      "type": "object",
      "properties": {
        "count": {
          "type": "integer",
          "minimum": 0
        },
        "per_gene": {
          "type": "number",
          "minimum": 0
        },
        "length_stats": {
          "$ref": "#/definitions/basicLengthStats"
        },
        "feature_stats": {
          "$ref": "#/definitions/featureStats"
        }
      },
      "required": ["count", "per_gene", "length_stats", "feature_stats"],
      "additionalProperties": false
    },
    "basicLengthStats": {
      "type": "object",
      "properties": {
        "mean": {
          "type": "number",
          "minimum": 0
        },
        "median": {
          "type": "number",
          "minimum": 0
        }
      },
      "required": ["mean", "median"],
      "additionalProperties": false
    },
    "featureStats": {
      "type": "object",
      "properties": {
        "exons": {
          "$ref": "#/definitions/featureTypeStats"
        },
        "introns": {
          "$ref": "#/definitions/featureTypeStats"
        },
        "cds": {
          "$ref": "#/definitions/featureTypeStats"
        }
      },
      "required": ["exons"],
      "additionalProperties": false
    },
    "featureTypeStats": {
      "type": "object",
      "properties": {
        "count": {
          "$ref": "#/definitions/basicLengthStats"
        },
        "average_length": {
          "$ref": "#/definitions/basicLengthStats"
        },
        "concatenated_length": {
          "$ref": "#/definitions/basicLengthStats"
        }
      },
      "required": ["count"],
      "additionalProperties": false
    }
  }
}

